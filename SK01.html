<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SK01 SEL-3C40</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            overflow: hidden;
        }

        nav {
            background-color: #5a7184;
            color: white;
            width: 200px;
            padding: 20px;
            height: 100vh;
        }

        nav h2 {
            margin: 0 0 20px;
        }

        nav button {
            width: 100%;
            padding: 10px;
            margin-bottom: 10px;
            border: none;
            background-color: #6a849a;
            color: white;
            cursor: pointer;
            font-size: 16px;
            text-align: left;
        }

        nav button:hover {
            background-color: #7a95ad;
        }

        main {
            flex-grow: 1;
            padding: 20px;
            display: flex;
            flex-direction: column;
        }

        h1 {
            text-align: center;
            color: #5a7184;
        }

        h3 {
            text-align: center;
            margin: 0 0 5px;
            color: white;
        }

        .container {
            flex: 1;
            padding: 20px;
        }

        .row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .table-container {
            border: 1px solid black;
            padding: 10px;
            width: 31%;
            margin-right: 20px;
            background: #5a7184;
        }

        .table-container-foto {
            border: 1px solid black;
            padding: 10px;
            width: 14%;
            margin-right: 300px; /* Adiciona margem à direita */
            text-align: center;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            border: 1px solid black;
            padding: 5px;
            text-align: center;
        }

        .full-width {
            width: 80%;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <nav>
        <h2>_______________</h2>
        <h2>Menu</h2>
        <button onclick="window.location.href='Index.html'">ESTOQUE SK</button>
        <button onclick="window.location.href='HISTÓRICO.html'">HISTÓRICO</button>
        <h2>_______________</h2>
        <h2>Informações</h2>
        <button onclick="window.location.href='SK01.html'">SK01 SEL-3C40</button>
        <button onclick="window.location.href='SK02.html'">SK02 BDC-4B28</button>
        <button onclick="window.location.href='SK03.html'">SK03 TAO-1A51</button>
    </nav>
    <main>
        <h1>SK01 SEL-3C40</h1>

        <div class="container">
            <div class="row">
                <div class="table-container">
                    <h3>CAMINHÃO</h3>
                    <table style="background: white;">
                        <tr><th style="background: #FFC000;">PLACA</th><td>SEL-3C40</td></tr>
                        <tr><th style="background: #FFC000;">CÓDIGO RENAVAM</th><td>01192328989</td></tr>
                        <tr><th style="background: #FFC000;">CHASSI</th><td>953658247KR930997</td></tr>
                        <tr><th style="background: #FFC000;">MOTOR</th><td>2095273A305269</td></tr>
                        <tr><th style="background: #FFC000;">ANO FAB./ MODELO</th><td>2018 / 2019</td></tr>
                        <tr><th style="background: #FFC000;">MODELO</th><td>VW/24.280 CRM 6X2</td></tr>
                        <tr><th style="background: #FFC000;">ESPÉCIE / TIPO</th><td>CARGA CAMINHÃO</td></tr>
                    </table>
                </div>

                <div class="table-container">
                    <h3>MÁQUINA SK3000</h3>
                    <table style="background: white;">
                        <tr><th style="background: #FFC000;">MODEL</th><td>SK3000</td></tr>
                        <tr><th style="background: #FFC000;">SERIAL</th><td>10420</td></tr>
                        <tr><th style="background: #FFC000;">JOB</th><td>1417</td></tr>
                        <tr><th style="background: #FFC000;">DATE</th><td>FEB 2010</td></tr>
                        <tr><td style="background: #FFC000;">-</td><td>-</td></tr>
                        <tr><td style="background: #FFC000;">-</td><td>-</td></tr>
                        <tr><td style="background: #FFC000;">-</td><td>-</td></tr>
                    </table>
                </div>

                <div class="table-container-foto">
                    <img src="https://lh3.googleusercontent.com/pw/AP1GczMju0c0Z-V6Kfxj8AiVr5sP8W3OD2Dy5zJbzt7yr8nJMR7GAxAecz_weqxVcsW3QVxNd0VyQsYbsTLznylLHIHA0NDxSr6U4cbmmLHwXtp05MhjQnxUZ4m8cUaZSLEfgnVSzFOJ1beZjltmb2D96jOK=w846-h919-s-no-gm?authuser=0" alt="Imagem" style="max-width: 100%; height: auto;">
                </div>
            </div>

            <h1 style="text-align: left; margin: 0 0 20px;">_________________________________________________________________________</h1>

            <div class="row">
                <div class="table-container full-width">
                    <h3>MÁQUINA DE REMOÇÃO</h3>
                    <table style="background: #FFC000;">
                        <tr>
                            <th style="width: 330px;">ITENS DE ETIQUETA</th>
                            <th>HR À VENCER</th>
                            <th>HR	 ATUAL</th>
                            <th>RESIDUAL</th>
                            <th>PERIODICIDADE</th>
                            <th>SITUAÇÃO</th>
                        </tr>
                        <tr>
                            <th style="background: white;">BOMBA DE ALTA PRESSÃO (ÓLEO)</th>
                            <td id="km_vencer_1" style="background: white;"></td>
                            <td id="km_atual_1" style="background: white;"></td>
                            <td id="residual_1" style="background: #FCE4D6;"></td>
                            <td id="periodicidade_1" style="background: white;"></td>
                            <td id="situacao_1" style="background: white;"></td>
                        </tr>

                        <tr>
                            <th style="background: white;">BOMBA DE VACUO (ÓLEO)</th>
                            <td id="km_vencer_2" style="background: white;"></td>
                            <td id="km_atual_2" style="background: white;"></td>
                            <td id="residual_2" style="background: #FCE4D6;"></td>
                            <td id="periodicidade_2" style="background: white;"></td>
                            <td id="situacao_2" style="background: white;"></td>
                        </tr>

                        <tr>
                            <th style="background: white;">BOMBA DE ALTA PRESSÃO (REVISÃO)</th>
                            <td id="km_vencer_3" style="background: white;"></td>
                            <td id="km_atual_3" style="background: white;"></td>
                            <td id="residual_3" style="background: #FCE4D6;"></td>
                            <td id="periodicidade_3" style="background: white;"></td>
                            <td id="situacao_3" style="background: white;"></td>
                        </tr>

                        <tr>
                            <th style="background: white;">BOMBA DE ALTA PRESSÃO (RETENTOR)</th>
                            <td id="km_vencer_4" style="background: white;"></td>
                            <td id="km_atual_4" style="background: white;"></td>
                            <td id="residual_4" style="background: #FCE4D6;"></td>
                            <td id="periodicidade_4" style="background: white;"></td>
                            <td id="situacao_4" style="background: white;"></td>
                        </tr>
                    </table>
                </div>
            </div>

            <div class="row">
                <div class="table-container full-width">
                    <h3>OBSERVAÇÕES</h3>
                    <table style="background: white;">
                        <tr>
                            <th style="width: 50px; background: #FFC000;">01</th>
                            <td id="observacao_1"></td>
                        </tr>
                        <tr>
                            <th style="background: #FFC000;">02</th>
                            <td id="observacao_2"></td>
                        </tr>
                        <tr>
                            <th style="background: #FFC000;">03</th>
                            <td id="observacao_3"></td>
                        </tr>
                        <tr>
                            <th style="background: #FFC000;">04</th>
                            <td id="observacao_4"></td>
                        </tr>
                        <tr>
                            <th style="background: #FFC000;">05</th>
                            <td id="observacao_5"></td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
    </main>

    <script>
        // Função para carregar os dados da Planilha Google
        function loadData() {
            const sheetId = "1ik7FzWqoqiA6VUtU_-U2uoOJiEJm4gJlfqbuvpinVbw"; // ID da Planilha
            const apiKey = "AIzaSyBwrglRLr-0Bj5c4kwc-c8QVeWYTqQMco0"; // Sua chave da API
            const range = "KM!B3:F6"; // Intervalo de dados da aba "KM" para a parte da Máquina de Remoção

            const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/${range}?key=${apiKey}`;

            fetch(url)
                .then(response => response.json())
                .then(data => {
                    if (data.values) {
                        // Preenchendo os dados nas células das tabelas
                        for (let i = 0; i < 4; i++) {
                            document.getElementById(`km_vencer_${i + 1}`).innerText = data.values[i][0];
                            document.getElementById(`km_atual_${i + 1}`).innerText = data.values[i][1];
                            document.getElementById(`residual_${i + 1}`).innerText = data.values[i][2];
                            document.getElementById(`periodicidade_${i + 1}`).innerText = data.values[i][3];
                            document.getElementById(`situacao_${i + 1}`).innerText = data.values[i][4];

                            // Lógica para mudar a cor da célula "SITUAÇÃO"
                            const situacaoCell = document.getElementById(`situacao_${i + 1}`);
                            if (situacaoCell.innerText === "A VENCER") {
                                situacaoCell.style.color = "#006400";  // Verde escuro
                                situacaoCell.style.backgroundColor = "#C6EFCE";  // Verde claro
                            } else if (situacaoCell.innerText === "VENCIDO") {
                                situacaoCell.style.color = "#8B0000";  // Vermelho escuro
                                situacaoCell.style.backgroundColor = "#FFC7CE";  // Vermelho claro
                            }
                        }
                    }
                })
                .catch(error => console.error("Erro ao buscar dados da planilha:", error));

            // Agora, para as Observações, pegamos os dados da coluna A de A9 a A13
            const observacoesRange = "KM!A9:A13"; // Intervalo das observações

            const observacoesUrl = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/${observacoesRange}?key=${apiKey}`;

            fetch(observacoesUrl)
                .then(response => response.json())
                .then(data => {
                    if (data.values) {
                        for (let i = 0; i < data.values.length; i++) {
                            document.getElementById(`observacao_${i + 1}`).innerText = data.values[i][0];
                        }
                    }
                })
                .catch(error => console.error("Erro ao buscar observações:", error));
        }

        // Carregar os dados ao carregar a página
        window.onload = loadData;
    </script>
</body>
</html>
